---
layout: slide
title: "Types for ML"
description: Types for ML propaganda for PLDI PC meeting
date: 2018-02-05 00:00:00 -0500
theme: white
transition: slide
categories: Types ML
---

<section style="background: white;">
<img src="/images/WALA.png" border="0" style="border-width: 0px;"/>
</section>

<section style="text-align: center;">
<h3 style="margin-top: 0;">Types for Machine Learning</h3>
<br />
<br />
<br />
<p>Julian Dolby</p>
<p>IBM Thomas J. Watson Research Center</p>
<br />
<br />
<br />
<br />
<p><small>PLDI PC Meeting Workshop, February 2018</small></p>
</section>

<section markdown="1">
<h3>Outline</h3>


* What is the problem?
* Why is the problem?
* How can types and analysis help?
* Status

</section>

<section>
<h3>MNIST data</h3>

<img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Example-MNIST-images.png" height="400"/>

</section>

<section markdown="1">
<h3>Machine learning with MNIST</h3>


* Sets of 28x28 images used as training, test data


~~~~
# Import MNIST data
from tensorflow.examples.tutorials.mnist import input_data
mnist = input_data.read_data_sets("/tmp/data/", one_hot=False)
~~~~


* Conceptually `mnist.train.data` image array
  * grayscale, 1 value per pixel
  * read as arrays of 784 ($28*28$) numbers
  * result is a tensor of (number of images) x 784


</section>

<section markdown="1">
<h3>Machine learning with MNIST</h3>

* Recognize digits from images

* Neural network from original image "features"
  * images can be smoothed, convolved, etc
  * Tensorflow provides many manipulations

* Focus on single 2-d convolution example (line 45)
  * 784-element vector wrong shape for 2D operation
  * need to reshape it (line 42)
  
</section>

<section>
<h3>Example with MNIST data</h3>

<iframe srcdoc="<!DOCTYPE html><html lang=&quot;en&quot;>  <head>    <meta charset=&quot;utf-8&quot;>  <link rel=&quot;dns-prefetch&quot; href=&quot;https://assets-cdn.github.com&quot;>  <link rel=&quot;dns-prefetch&quot; href=&quot;https://avatars0.githubusercontent.com&quot;>  <link rel=&quot;dns-prefetch&quot; href=&quot;https://avatars1.githubusercontent.com&quot;>  <link rel=&quot;dns-prefetch&quot; href=&quot;https://avatars2.githubusercontent.com&quot;>  <link rel=&quot;dns-prefetch&quot; href=&quot;https://avatars3.githubusercontent.com&quot;>  <link rel=&quot;dns-prefetch&quot; href=&quot;https://github-cloud.s3.amazonaws.com&quot;>  <link rel=&quot;dns-prefetch&quot; href=&quot;https://user-images.githubusercontent.com/&quot;>  <link crossorigin=&quot;anonymous&quot; href=&quot;https://assets-cdn.github.com/assets/frameworks-521cbf980c80.css&quot; integrity=&quot;sha512-Uhy/mAyAx1HfsenmjQ85ASpOk5bjt2Ay03pNeixXIvkHlEm5S+N4u0HWfDGhvsGYx4bGyviXWGGPZeIffqYcNA==&quot; media=&quot;all&quot; rel=&quot;stylesheet&quot; />  <link crossorigin=&quot;anonymous&quot; href=&quot;https://assets-cdn.github.com/assets/github-be0481bef7d9.css&quot; integrity=&quot;sha512-vgSBvvfZP2Kl3LF7M/gHnUD7GKfHl7aTSB55Cjr6xHkxaP/InJ41AXLEEy+6mArnvt2HJPmZYqGoIRqAZg352Q==&quot; media=&quot;all&quot; rel=&quot;stylesheet&quot; />      <link crossorigin=&quot;anonymous&quot; href=&quot;https://assets-cdn.github.com/assets/site-e1e1bc98a53e.css&quot; integrity=&quot;sha512-4eG8mKU+R9QAnMQwfSIgbo24hS+nUXxSuUs5G5LMQw+5wjC1TSKfgxJb2j61PXya94+wMwN1OT7r7MF5rbdUvw==&quot; media=&quot;all&quot; rel=&quot;stylesheet&quot; />    <meta name=&quot;viewport&quot; content=&quot;width=device-width&quot;>    <title>TensorFlow-Examples/convolutional_network.py at dd2e6dcd9603d5de008d8c766453162d0204affa · aymericdamien/TensorFlow-Examples · GitHub</title>  <link rel=&quot;search&quot; type=&quot;application/opensearchdescription+xml&quot; href=&quot;/opensearch.xml&quot; title=&quot;GitHub&quot;>  <link rel=&quot;fluid-icon&quot; href=&quot;https://github.com/fluidicon.png&quot; title=&quot;GitHub&quot;>  <meta property=&quot;fb:app_id&quot; content=&quot;1401488693436528&quot;>        <meta content=&quot;https://avatars3.githubusercontent.com/u/10386605?s=400&amp;v=4&quot; property=&quot;og:image&quot; /><meta content=&quot;GitHub&quot; property=&quot;og:site_name&quot; /><meta content=&quot;object&quot; property=&quot;og:type&quot; /><meta content=&quot;aymericdamien/TensorFlow-Examples&quot; property=&quot;og:title&quot; /><meta content=&quot;https://github.com/aymericdamien/TensorFlow-Examples&quot; property=&quot;og:url&quot; /><meta content=&quot;TensorFlow-Examples - TensorFlow Tutorial and Examples for Beginners with Latest APIs&quot; property=&quot;og:description&quot; />  <link rel=&quot;assets&quot; href=&quot;https://assets-cdn.github.com/&quot;>    <meta name=&quot;pjax-timeout&quot; content=&quot;1000&quot;>    <meta name=&quot;request-id&quot; content=&quot;FBA7:23B0F:B12E6:FF533:5A79DD3D&quot; data-pjax-transient>    <meta name=&quot;selected-link&quot; value=&quot;repo_source&quot; data-pjax-transient>    <meta name=&quot;google-site-verification&quot; content=&quot;KT5gs8h0wvaagLKAVWq8bbeNwnZZK1r1XQysX3xurLU&quot;>  <meta name=&quot;google-site-verification&quot; content=&quot;ZzhVyEFwb7w3e0-uOTltm8Jsck2F5StVihD0exw2fsA&quot;>  <meta name=&quot;google-site-verification&quot; content=&quot;GXs5KoUUkNCoaAZn7wPN-t01Pywp9M3sEjnt_3_ZWPc&quot;>    <meta name=&quot;google-analytics&quot; content=&quot;UA-3769691-2&quot;><meta content=&quot;collector.githubapp.com&quot; name=&quot;octolytics-host&quot; /><meta content=&quot;github&quot; name=&quot;octolytics-app-id&quot; /><meta content=&quot;https://collector.githubapp.com/github-external/browser_event&quot; name=&quot;octolytics-event-url&quot; /><meta content=&quot;FBA7:23B0F:B12E6:FF533:5A79DD3D&quot; name=&quot;octolytics-dimension-request_id&quot; /><meta content=&quot;sea&quot; name=&quot;octolytics-dimension-region_edge&quot; /><meta content=&quot;iad&quot; name=&quot;octolytics-dimension-region_render&quot; /><meta content=&quot;https://github.com/hydro_browser_events&quot; name=&quot;hydro-events-url&quot; /><meta content=&quot;/&lt;user-name&gt;/&lt;repo-name&gt;/blob/show&quot; data-pjax-transient=&quot;true&quot; name=&quot;analytics-location&quot; />  <meta class=&quot;js-ga-set&quot; name=&quot;dimension1&quot; content=&quot;Logged Out&quot;>        <meta name=&quot;hostname&quot; content=&quot;github.com&quot;>  <meta name=&quot;user-login&quot; content=&quot;&quot;>      <meta name=&quot;expected-hostname&quot; content=&quot;github.com&quot;>    <meta name=&quot;js-proxy-site-detection-payload&quot; content=&quot;NDRkNGRmZDYyOGJmOGIyZjFiMjI5N2E5MGM0ODBkY2Q3Y2NhNzliYjA0ODE3NTMxNTJiNGZjOGQ0MDFhMThkN3x7InJlbW90ZV9hZGRyZXNzIjoiMTA4LjE3OS4xNDcuNzEiLCJyZXF1ZXN0X2lkIjoiRkJBNzoyM0IwRjpCMTJFNjpGRjUzMzo1QTc5REQzRCIsInRpbWVzdGFtcCI6MTUxNzkzNTkzMywiaG9zdCI6ImdpdGh1Yi5jb20ifQ==&quot;>    <meta name=&quot;enabled-features&quot; content=&quot;UNIVERSE_BANNER,FREE_TRIALS,MARKETPLACE_HERO_CARD_UPLOADER&quot;>  <meta name=&quot;html-safe-nonce&quot; content=&quot;78b667bbb2a08efbecb523960ceef1397620ba22&quot;>  <meta http-equiv=&quot;x-pjax-version&quot; content=&quot;731587b3fae01213175f7d7091cf8673&quot;>        <link href=&quot;https://github.com/aymericdamien/TensorFlow-Examples/commits/dd2e6dcd9603d5de008d8c766453162d0204affa.atom&quot; rel=&quot;alternate&quot; title=&quot;Recent Commits to TensorFlow-Examples:dd2e6dcd9603d5de008d8c766453162d0204affa&quot; type=&quot;application/atom+xml&quot;>  <meta name=&quot;description&quot; content=&quot;TensorFlow-Examples - TensorFlow Tutorial and Examples for Beginners with Latest APIs&quot;>  <meta name=&quot;go-import&quot; content=&quot;github.com/aymericdamien/TensorFlow-Examples git https://github.com/aymericdamien/TensorFlow-Examples.git&quot;>  <meta content=&quot;10386605&quot; name=&quot;octolytics-dimension-user_id&quot; /><meta content=&quot;aymericdamien&quot; name=&quot;octolytics-dimension-user_login&quot; /><meta content=&quot;45986162&quot; name=&quot;octolytics-dimension-repository_id&quot; /><meta content=&quot;aymericdamien/TensorFlow-Examples&quot; name=&quot;octolytics-dimension-repository_nwo&quot; /><meta content=&quot;true&quot; name=&quot;octolytics-dimension-repository_public&quot; /><meta content=&quot;false&quot; name=&quot;octolytics-dimension-repository_is_fork&quot; /><meta content=&quot;45986162&quot; name=&quot;octolytics-dimension-repository_network_root_id&quot; /><meta content=&quot;aymericdamien/TensorFlow-Examples&quot; name=&quot;octolytics-dimension-repository_network_root_nwo&quot; /><meta content=&quot;false&quot; name=&quot;octolytics-dimension-repository_explore_github_marketplace_ci_cta_shown&quot; />    <link rel=&quot;canonical&quot; href=&quot;https://github.com/aymericdamien/TensorFlow-Examples/blob/dd2e6dcd9603d5de008d8c766453162d0204affa/examples/3_NeuralNetworks/convolutional_network.py&quot; data-pjax-transient>  <meta name=&quot;browser-stats-url&quot; content=&quot;https://api.github.com/_private/browser/stats&quot;>  <meta name=&quot;browser-errors-url&quot; content=&quot;https://api.github.com/_private/browser/errors&quot;>  <link rel=&quot;mask-icon&quot; href=&quot;https://assets-cdn.github.com/pinned-octocat.svg&quot; color=&quot;#000000&quot;>  <link rel=&quot;icon&quot; type=&quot;image/x-icon&quot; class=&quot;js-site-favicon&quot; href=&quot;https://assets-cdn.github.com/favicon.ico&quot;><meta name=&quot;theme-color&quot; content=&quot;#1e2327&quot;>  <meta name=&quot;u2f-support&quot; content=&quot;true&quot;>  </head>  <body class=&quot;logged-out env-production emoji-size-boost page-blob&quot;>      <div class=&quot;position-relative js-header-wrapper &quot;>    <a href=&quot;#start-of-content&quot; tabindex=&quot;1&quot; class=&quot;px-2 py-4 show-on-focus js-skip-to-content&quot;>Skip to content</a>    <div id=&quot;js-pjax-loader-bar&quot; class=&quot;pjax-loader-bar&quot;><div class=&quot;progress&quot;></div></div>                    <header class=&quot;Header header-logged-out  position-relative f4 py-3&quot; role=&quot;banner&quot;>  <div class=&quot;container-lg d-flex px-3&quot;>    <div class=&quot;d-flex flex-justify-between flex-items-center&quot;>      <a class=&quot;header-logo-invertocat my-0&quot; href=&quot;https://github.com/&quot; aria-label=&quot;Homepage&quot; data-ga-click=&quot;(Logged out) Header, go to homepage, icon:logo-wordmark&quot;>        <svg aria-hidden=&quot;true&quot; class=&quot;octicon octicon-mark-github&quot; height=&quot;32&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;32&quot;><path fill-rule=&quot;evenodd&quot; d=&quot;M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z&quot;/></svg>      </a>    </div>    <div class=&quot;HeaderMenu HeaderMenu--bright d-flex flex-justify-between flex-auto&quot;>        <nav class=&quot;mt-0&quot;>          <ul class=&quot;d-flex list-style-none&quot;>              <li class=&quot;ml-2&quot;>                <a href=&quot;/features&quot; class=&quot;js-selected-navigation-item HeaderNavlink px-0 py-2 m-0&quot; data-ga-click=&quot;Header, click, Nav menu - item:features&quot; data-selected-links=&quot;/features /features/project-management /features/code-review /features/project-management /features/integrations /features&quot;>                  Features</a>              </li>              <li class=&quot;ml-4&quot;>                <a href=&quot;/business&quot; class=&quot;js-selected-navigation-item HeaderNavlink px-0 py-2 m-0&quot; data-ga-click=&quot;Header, click, Nav menu - item:business&quot; data-selected-links=&quot;/business /business/security /business/customers /business&quot;>                  Business</a>              </li>              <li class=&quot;ml-4&quot;>                <a href=&quot;/explore&quot; class=&quot;js-selected-navigation-item HeaderNavlink px-0 py-2 m-0&quot; data-ga-click=&quot;Header, click, Nav menu - item:explore&quot; data-selected-links=&quot;/explore /trending /trending/developers /integrations /integrations/feature/code /integrations/feature/collaborate /integrations/feature/ship showcases showcases_search showcases_landing /explore&quot;>                  Explore</a>              </li>              <li class=&quot;ml-4&quot;>                    <a href=&quot;/marketplace&quot; class=&quot;js-selected-navigation-item HeaderNavlink px-0 py-2 m-0&quot; data-ga-click=&quot;Header, click, Nav menu - item:marketplace&quot; data-selected-links=&quot; /marketplace&quot;>                      Marketplace</a>              </li>              <li class=&quot;ml-4&quot;>                <a href=&quot;/pricing&quot; class=&quot;js-selected-navigation-item HeaderNavlink px-0 py-2 m-0&quot; data-ga-click=&quot;Header, click, Nav menu - item:pricing&quot; data-selected-links=&quot;/pricing /pricing/developer /pricing/team /pricing/business-hosted /pricing/business-enterprise /pricing&quot;>                  Pricing</a>              </li>          </ul>        </nav>      <div class=&quot;d-flex&quot;>          <div class=&quot;d-lg-flex flex-items-center mr-3&quot;>            <div class=&quot;header-search scoped-search site-scoped-search js-site-search&quot; role=&quot;search&quot;>  <!-- '&quot;` --><!-- </textarea></xmp> --></option></form><form accept-charset=&quot;UTF-8&quot; action=&quot;/aymericdamien/TensorFlow-Examples/search&quot; class=&quot;js-site-search-form&quot; data-scoped-search-url=&quot;/aymericdamien/TensorFlow-Examples/search&quot; data-unscoped-search-url=&quot;/search&quot; method=&quot;get&quot;><div style=&quot;margin:0;padding:0;display:inline&quot;><input name=&quot;utf8&quot; type=&quot;hidden&quot; value=&quot;&#x2713;&quot; /></div>    <label class=&quot;form-control header-search-wrapper js-chromeless-input-container&quot;>        <a href=&quot;/aymericdamien/TensorFlow-Examples/blob/dd2e6dcd9603d5de008d8c766453162d0204affa/examples/3_NeuralNetworks/convolutional_network.py&quot; class=&quot;header-search-scope no-underline&quot;>This repository</a>      <input type=&quot;text&quot;        class=&quot;form-control header-search-input js-site-search-focus js-site-search-field is-clearable&quot;        data-hotkey=&quot;s&quot;        name=&quot;q&quot;        value=&quot;&quot;        placeholder=&quot;Search&quot;        aria-label=&quot;Search this repository&quot;        data-unscoped-placeholder=&quot;Search GitHub&quot;        data-scoped-placeholder=&quot;Search&quot;        autocapitalize=&quot;off&quot;>        <input type=&quot;hidden&quot; class=&quot;js-site-search-type-field&quot; name=&quot;type&quot; >    </label></form></div>          </div>        <span class=&quot;d-inline-block&quot;>            <div class=&quot;HeaderNavlink px-0 py-2 m-0&quot;>              <a class=&quot;text-bold text-white no-underline&quot; href=&quot;/login?return_to=%2Faymericdamien%2FTensorFlow-Examples%2Fblob%2Fdd2e6dcd9603d5de008d8c766453162d0204affa%2Fexamples%2F3_NeuralNetworks%2Fconvolutional_network.py&quot; data-ga-click=&quot;(Logged out) Header, clicked Sign in, text:sign-in&quot;>Sign in</a>                <span class=&quot;text-gray&quot;>or</span>                <a class=&quot;text-bold text-white no-underline&quot; href=&quot;/join?source=header-repo&quot; data-ga-click=&quot;(Logged out) Header, clicked Sign up, text:sign-up&quot;>Sign up</a>            </div>        </span>      </div>    </div>  </div></header>  </div>  <div id=&quot;start-of-content&quot; class=&quot;show-on-focus&quot;></div>    <div id=&quot;js-flash-container&quot;></div>  <div role=&quot;main&quot; class=&quot;application-main &quot;>        <div itemscope itemtype=&quot;http://schema.org/SoftwareSourceCode&quot; class=&quot;&quot;>    <div id=&quot;js-repo-pjax-container&quot; data-pjax-container >        <div class=&quot;pagehead repohead instapaper_ignore readability-menu experiment-repo-nav  &quot;>    <div class=&quot;repohead-details-container clearfix container&quot;>      <ul class=&quot;pagehead-actions&quot;>  <li>      <a href=&quot;/login?return_to=%2Faymericdamien%2FTensorFlow-Examples&quot;    class=&quot;btn btn-sm btn-with-count tooltipped tooltipped-n&quot;    aria-label=&quot;You must be signed in to watch a repository&quot; rel=&quot;nofollow&quot;>    <svg aria-hidden=&quot;true&quot; class=&quot;octicon octicon-eye&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;><path fill-rule=&quot;evenodd&quot; d=&quot;M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z&quot;/></svg>    Watch  </a>  <a class=&quot;social-count&quot; href=&quot;/aymericdamien/TensorFlow-Examples/watchers&quot;     aria-label=&quot;1415 users are watching this repository&quot;>    1,415  </a>  </li>  <li>      <a href=&quot;/login?return_to=%2Faymericdamien%2FTensorFlow-Examples&quot;    class=&quot;btn btn-sm btn-with-count tooltipped tooltipped-n&quot;    aria-label=&quot;You must be signed in to star a repository&quot; rel=&quot;nofollow&quot;>    <svg aria-hidden=&quot;true&quot; class=&quot;octicon octicon-star&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 14 16&quot; width=&quot;14&quot;><path fill-rule=&quot;evenodd&quot; d=&quot;M14 6l-4.9-.64L7 1 4.9 5.36 0 6l3.6 3.26L2.67 14 7 11.67 11.33 14l-.93-4.74z&quot;/></svg>    Star  </a>    <a class=&quot;social-count js-social-count&quot; href=&quot;/aymericdamien/TensorFlow-Examples/stargazers&quot;      aria-label=&quot;19909 users starred this repository&quot;>      19,909    </a>  </li>  <li>      <a href=&quot;/login?return_to=%2Faymericdamien%2FTensorFlow-Examples&quot;        class=&quot;btn btn-sm btn-with-count tooltipped tooltipped-n&quot;        aria-label=&quot;You must be signed in to fork a repository&quot; rel=&quot;nofollow&quot;>        <svg aria-hidden=&quot;true&quot; class=&quot;octicon octicon-repo-forked&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 10 16&quot; width=&quot;10&quot;><path fill-rule=&quot;evenodd&quot; d=&quot;M8 1a1.993 1.993 0 0 0-1 3.72V6L5 8 3 6V4.72A1.993 1.993 0 0 0 2 1a1.993 1.993 0 0 0-1 3.72V6.5l3 3v1.78A1.993 1.993 0 0 0 5 15a1.993 1.993 0 0 0 1-3.72V9.5l3-3V4.72A1.993 1.993 0 0 0 8 1zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3 10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3-10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z&quot;/></svg>        Fork      </a>    <a href=&quot;/aymericdamien/TensorFlow-Examples/network&quot; class=&quot;social-count&quot;       aria-label=&quot;6879 users forked this repository&quot;>      6,879    </a>  </li></ul>      <h1 class=&quot;public &quot;>  <svg aria-hidden=&quot;true&quot; class=&quot;octicon octicon-repo&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 12 16&quot; width=&quot;12&quot;><path fill-rule=&quot;evenodd&quot; d=&quot;M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z&quot;/></svg>  <span class=&quot;author&quot; itemprop=&quot;author&quot;><a href=&quot;/aymericdamien&quot; class=&quot;url fn&quot; rel=&quot;author&quot;>aymericdamien</a></span><!----><span class=&quot;path-divider&quot;>/</span><!----><strong itemprop=&quot;name&quot;><a href=&quot;/aymericdamien/TensorFlow-Examples&quot; data-pjax=&quot;#js-repo-pjax-container&quot;>TensorFlow-Examples</a></strong></h1>    </div>    <nav class=&quot;reponav js-repo-nav js-sidenav-container-pjax container&quot;     itemscope     itemtype=&quot;http://schema.org/BreadcrumbList&quot;     role=&quot;navigation&quot;     data-pjax=&quot;#js-repo-pjax-container&quot;>  <span itemscope itemtype=&quot;http://schema.org/ListItem&quot; itemprop=&quot;itemListElement&quot;>    <a href=&quot;/aymericdamien/TensorFlow-Examples&quot; class=&quot;js-selected-navigation-item selected reponav-item&quot; data-hotkey=&quot;g c&quot; data-selected-links=&quot;repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches repo_packages /aymericdamien/TensorFlow-Examples&quot; itemprop=&quot;url&quot;>      <svg aria-hidden=&quot;true&quot; class=&quot;octicon octicon-code&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 14 16&quot; width=&quot;14&quot;><path fill-rule=&quot;evenodd&quot; d=&quot;M9.5 3L8 4.5 11.5 8 8 11.5 9.5 13 14 8 9.5 3zm-5 0L0 8l4.5 5L6 11.5 2.5 8 6 4.5 4.5 3z&quot;/></svg>      <span itemprop=&quot;name&quot;>Code</span>      <meta itemprop=&quot;position&quot; content=&quot;1&quot;></a>  </span>    <span itemscope itemtype=&quot;http://schema.org/ListItem&quot; itemprop=&quot;itemListElement&quot;>      <a href=&quot;/aymericdamien/TensorFlow-Examples/issues&quot; class=&quot;js-selected-navigation-item reponav-item&quot; data-hotkey=&quot;g i&quot; data-selected-links=&quot;repo_issues repo_labels repo_milestones /aymericdamien/TensorFlow-Examples/issues&quot; itemprop=&quot;url&quot;>        <svg aria-hidden=&quot;true&quot; class=&quot;octicon octicon-issue-opened&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 14 16&quot; width=&quot;14&quot;><path fill-rule=&quot;evenodd&quot; d=&quot;M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z&quot;/></svg>        <span itemprop=&quot;name&quot;>Issues</span>        <span class=&quot;Counter&quot;>87</span>        <meta itemprop=&quot;position&quot; content=&quot;2&quot;></a>    </span>  <span itemscope itemtype=&quot;http://schema.org/ListItem&quot; itemprop=&quot;itemListElement&quot;>    <a href=&quot;/aymericdamien/TensorFlow-Examples/pulls&quot; class=&quot;js-selected-navigation-item reponav-item&quot; data-hotkey=&quot;g p&quot; data-selected-links=&quot;repo_pulls /aymericdamien/TensorFlow-Examples/pulls&quot; itemprop=&quot;url&quot;>      <svg aria-hidden=&quot;true&quot; class=&quot;octicon octicon-git-pull-request&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 12 16&quot; width=&quot;12&quot;><path fill-rule=&quot;evenodd&quot; d=&quot;M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z&quot;/></svg>      <span itemprop=&quot;name&quot;>Pull requests</span>      <span class=&quot;Counter&quot;>23</span>      <meta itemprop=&quot;position&quot; content=&quot;3&quot;></a>  </span>    <a href=&quot;/aymericdamien/TensorFlow-Examples/projects&quot; class=&quot;js-selected-navigation-item reponav-item&quot; data-hotkey=&quot;g b&quot; data-selected-links=&quot;repo_projects new_repo_project repo_project /aymericdamien/TensorFlow-Examples/projects&quot;>      <svg aria-hidden=&quot;true&quot; class=&quot;octicon octicon-project&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 15 16&quot; width=&quot;15&quot;><path fill-rule=&quot;evenodd&quot; d=&quot;M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z&quot;/></svg>      Projects      <span class=&quot;Counter&quot; >0</span></a>    <a href=&quot;/aymericdamien/TensorFlow-Examples/wiki&quot; class=&quot;js-selected-navigation-item reponav-item&quot; data-hotkey=&quot;g w&quot; data-selected-links=&quot;repo_wiki /aymericdamien/TensorFlow-Examples/wiki&quot;>      <svg aria-hidden=&quot;true&quot; class=&quot;octicon octicon-book&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;><path fill-rule=&quot;evenodd&quot; d=&quot;M3 5h4v1H3V5zm0 3h4V7H3v1zm0 2h4V9H3v1zm11-5h-4v1h4V5zm0 2h-4v1h4V7zm0 2h-4v1h4V9zm2-6v9c0 .55-.45 1-1 1H9.5l-1 1-1-1H2c-.55 0-1-.45-1-1V3c0-.55.45-1 1-1h5.5l1 1 1-1H15c.55 0 1 .45 1 1zm-8 .5L7.5 3H2v9h6V3.5zm7-.5H9.5l-.5.5V12h6V3z&quot;/></svg>      Wiki</a>  <a href=&quot;/aymericdamien/TensorFlow-Examples/pulse&quot; class=&quot;js-selected-navigation-item reponav-item&quot; data-selected-links=&quot;repo_graphs repo_contributors dependency_graph pulse /aymericdamien/TensorFlow-Examples/pulse&quot;>    <svg aria-hidden=&quot;true&quot; class=&quot;octicon octicon-graph&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;><path fill-rule=&quot;evenodd&quot; d=&quot;M16 14v1H0V0h1v14h15zM5 13H3V8h2v5zm4 0H7V3h2v10zm4 0h-2V6h2v7z&quot;/></svg>    Insights</a></nav>  </div><div class=&quot;container new-discussion-timeline experiment-repo-nav  &quot;>  <div class=&quot;repository-content &quot;>      <a href=&quot;/aymericdamien/TensorFlow-Examples/blob/dd2e6dcd9603d5de008d8c766453162d0204affa/examples/3_NeuralNetworks/convolutional_network.py&quot; class=&quot;d-none js-permalink-shortcut&quot; data-hotkey=&quot;y&quot;>Permalink</a>  <!-- blob contrib key: blob_contributors:v21:b0b34e619500f854378b908af5610191 -->  <div class=&quot;file-navigation js-zeroclipboard-container&quot;>    <div class=&quot;select-menu branch-select-menu js-menu-container js-select-menu float-left&quot;>  <button class=&quot; btn btn-sm select-menu-button js-menu-target css-truncate&quot; data-hotkey=&quot;w&quot;        type=&quot;button&quot; aria-label=&quot;Switch branches or tags&quot; aria-expanded=&quot;false&quot; aria-haspopup=&quot;true&quot;>      <i>Tree:</i>      <span class=&quot;js-select-button css-truncate-target&quot;>dd2e6dcd96</span>  </button>  <div class=&quot;select-menu-modal-holder js-menu-content js-navigation-container&quot; data-pjax>    <div class=&quot;select-menu-modal&quot;>      <div class=&quot;select-menu-header&quot;>        <svg aria-label=&quot;Close&quot; class=&quot;octicon octicon-x js-menu-close&quot; height=&quot;16&quot; role=&quot;img&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 12 16&quot; width=&quot;12&quot;><path fill-rule=&quot;evenodd&quot; d=&quot;M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48z&quot;/></svg>        <span class=&quot;select-menu-title&quot;>Switch branches/tags</span>      </div>      <div class=&quot;select-menu-filters&quot;>        <div class=&quot;select-menu-text-filter&quot;>          <input type=&quot;text&quot; aria-label=&quot;Filter branches/tags&quot; id=&quot;context-commitish-filter-field&quot; class=&quot;form-control js-filterable-field js-navigation-enable&quot; placeholder=&quot;Filter branches/tags&quot;>        </div>        <div class=&quot;select-menu-tabs&quot;>          <ul>            <li class=&quot;select-menu-tab&quot;>              <a href=&quot;#&quot; data-tab-filter=&quot;branches&quot; data-filter-placeholder=&quot;Filter branches/tags&quot; class=&quot;js-select-menu-tab&quot; role=&quot;tab&quot;>Branches</a>            </li>            <li class=&quot;select-menu-tab&quot;>              <a href=&quot;#&quot; data-tab-filter=&quot;tags&quot; data-filter-placeholder=&quot;Find a tag…&quot; class=&quot;js-select-menu-tab&quot; role=&quot;tab&quot;>Tags</a>            </li>          </ul>        </div>      </div>      <div class=&quot;select-menu-list select-menu-tab-bucket js-select-menu-tab-bucket&quot; data-tab-filter=&quot;branches&quot; role=&quot;menu&quot;>        <div data-filterable-for=&quot;context-commitish-filter-field&quot; data-filterable-type=&quot;substring&quot;>            <a class=&quot;select-menu-item js-navigation-item js-navigation-open &quot;               href=&quot;/aymericdamien/TensorFlow-Examples/blob/0.11/examples/3_NeuralNetworks/convolutional_network.py&quot;               data-name=&quot;0.11&quot;               data-skip-pjax=&quot;true&quot;               rel=&quot;nofollow&quot;>              <svg aria-hidden=&quot;true&quot; class=&quot;octicon octicon-check select-menu-item-icon&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 12 16&quot; width=&quot;12&quot;><path fill-rule=&quot;evenodd&quot; d=&quot;M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5z&quot;/></svg>              <span class=&quot;select-menu-item-text css-truncate-target js-select-menu-filter-text&quot;>                0.11              </span>            </a>            <a class=&quot;select-menu-item js-navigation-item js-navigation-open &quot;               href=&quot;/aymericdamien/TensorFlow-Examples/blob/dev/examples/3_NeuralNetworks/convolutional_network.py&quot;               data-name=&quot;dev&quot;               data-skip-pjax=&quot;true&quot;               rel=&quot;nofollow&quot;>              <svg aria-hidden=&quot;true&quot; class=&quot;octicon octicon-check select-menu-item-icon&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 12 16&quot; width=&quot;12&quot;><path fill-rule=&quot;evenodd&quot; d=&quot;M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5z&quot;/></svg>              <span class=&quot;select-menu-item-text css-truncate-target js-select-menu-filter-text&quot;>                dev              </span>            </a>            <a class=&quot;select-menu-item js-navigation-item js-navigation-open &quot;               href=&quot;/aymericdamien/TensorFlow-Examples/blob/master/examples/3_NeuralNetworks/convolutional_network.py&quot;               data-name=&quot;master&quot;               data-skip-pjax=&quot;true&quot;               rel=&quot;nofollow&quot;>              <svg aria-hidden=&quot;true&quot; class=&quot;octicon octicon-check select-menu-item-icon&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 12 16&quot; width=&quot;12&quot;><path fill-rule=&quot;evenodd&quot; d=&quot;M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5z&quot;/></svg>              <span class=&quot;select-menu-item-text css-truncate-target js-select-menu-filter-text&quot;>                master              </span>            </a>        </div>          <div class=&quot;select-menu-no-results&quot;>Nothing to show</div>      </div>      <div class=&quot;select-menu-list select-menu-tab-bucket js-select-menu-tab-bucket&quot; data-tab-filter=&quot;tags&quot;>        <div data-filterable-for=&quot;context-commitish-filter-field&quot; data-filterable-type=&quot;substring&quot;>        </div>        <div class=&quot;select-menu-no-results&quot;>Nothing to show</div>      </div>    </div>  </div></div>    <div class=&quot;BtnGroup float-right&quot;>      <a href=&quot;/aymericdamien/TensorFlow-Examples/find/dd2e6dcd9603d5de008d8c766453162d0204affa&quot;            class=&quot;js-pjax-capture-input btn btn-sm BtnGroup-item&quot;            data-pjax            data-hotkey=&quot;t&quot;>        Find file      </a>      <button aria-label=&quot;Copy file path to clipboard&quot; class=&quot;js-zeroclipboard btn btn-sm BtnGroup-item tooltipped tooltipped-s&quot; data-copied-hint=&quot;Copied!&quot; type=&quot;button&quot;>Copy path</button>    </div>    <div class=&quot;breadcrumb js-zeroclipboard-target&quot;>      <span class=&quot;repo-root js-repo-root&quot;><span class=&quot;js-path-segment&quot;><a href=&quot;/aymericdamien/TensorFlow-Examples/tree/dd2e6dcd9603d5de008d8c766453162d0204affa&quot; data-pjax=&quot;true&quot; rel=&quot;nofollow&quot;><span>TensorFlow-Examples</span></a></span></span><span class=&quot;separator&quot;>/</span><span class=&quot;js-path-segment&quot;><a href=&quot;/aymericdamien/TensorFlow-Examples/tree/dd2e6dcd9603d5de008d8c766453162d0204affa/examples&quot; data-pjax=&quot;true&quot; rel=&quot;nofollow&quot;><span>examples</span></a></span><span class=&quot;separator&quot;>/</span><span class=&quot;js-path-segment&quot;><a href=&quot;/aymericdamien/TensorFlow-Examples/tree/dd2e6dcd9603d5de008d8c766453162d0204affa/examples/3_NeuralNetworks&quot; data-pjax=&quot;true&quot; rel=&quot;nofollow&quot;><span>3_NeuralNetworks</span></a></span><span class=&quot;separator&quot;>/</span><strong class=&quot;final-path&quot;>convolutional_network.py</strong>    </div>  </div>    <div class=&quot;commit-tease&quot;>      <span class=&quot;float-right&quot;>        <a class=&quot;commit-tease-sha&quot; href=&quot;/aymericdamien/TensorFlow-Examples/commit/72707e2314f38217f9977565982ea22e99830517&quot; data-pjax>          72707e2        </a>        <relative-time datetime=&quot;2017-09-20T22:22:31Z&quot;>Sep 20, 2017</relative-time>      </span>      <div>        <img alt=&quot;@alseambusher&quot; class=&quot;avatar&quot; height=&quot;20&quot; src=&quot;https://avatars3.githubusercontent.com/u/1242542?s=40&amp;v=4&quot; width=&quot;20&quot; />        <a href=&quot;/alseambusher&quot; class=&quot;user-mention&quot; rel=&quot;contributor&quot;>alseambusher</a>          <a href=&quot;/aymericdamien/TensorFlow-Examples/commit/72707e2314f38217f9977565982ea22e99830517&quot; class=&quot;message&quot; data-pjax=&quot;true&quot; title=&quot;Fix comment in convolutional_network.py (#173)&quot;>Fix comment in convolutional_network.py (</a><a href=&quot;https://github.com/aymericdamien/TensorFlow-Examples/pull/173&quot; class=&quot;issue-link js-issue-link&quot; data-error-text=&quot;Failed to load issue title&quot; data-id=&quot;257925008&quot; data-permission-text=&quot;Issue title is private&quot; data-url=&quot;https://github.com/aymericdamien/TensorFlow-Examples/issues/173&quot;>#173</a><a href=&quot;/aymericdamien/TensorFlow-Examples/commit/72707e2314f38217f9977565982ea22e99830517&quot; class=&quot;message&quot; data-pjax=&quot;true&quot; title=&quot;Fix comment in convolutional_network.py (#173)&quot;>)</a>      </div>    <div class=&quot;commit-tease-contributors&quot;>      <button type=&quot;button&quot; class=&quot;btn-link muted-link contributors-toggle&quot; data-facebox=&quot;#blob_contributors_box&quot;>        <strong>5</strong>         contributors      </button>          <a class=&quot;avatar-link tooltipped tooltipped-s&quot; aria-label=&quot;RWalecki&quot; href=&quot;/aymericdamien/TensorFlow-Examples/commits/dd2e6dcd9603d5de008d8c766453162d0204affa/examples/3_NeuralNetworks/convolutional_network.py?author=RWalecki&quot;><img alt=&quot;@RWalecki&quot; class=&quot;avatar&quot; height=&quot;20&quot; src=&quot;https://avatars2.githubusercontent.com/u/1379960?s=40&amp;v=4&quot; width=&quot;20&quot; /> </a>    <a class=&quot;avatar-link tooltipped tooltipped-s&quot; aria-label=&quot;aymericdamien&quot; href=&quot;/aymericdamien/TensorFlow-Examples/commits/dd2e6dcd9603d5de008d8c766453162d0204affa/examples/3_NeuralNetworks/convolutional_network.py?author=aymericdamien&quot;><img alt=&quot;@aymericdamien&quot; class=&quot;avatar&quot; height=&quot;20&quot; src=&quot;https://avatars0.githubusercontent.com/u/10386605?s=40&amp;v=4&quot; width=&quot;20&quot; /> </a>    <a class=&quot;avatar-link tooltipped tooltipped-s&quot; aria-label=&quot;vra&quot; href=&quot;/aymericdamien/TensorFlow-Examples/commits/dd2e6dcd9603d5de008d8c766453162d0204affa/examples/3_NeuralNetworks/convolutional_network.py?author=vra&quot;><img alt=&quot;@vra&quot; class=&quot;avatar&quot; height=&quot;20&quot; src=&quot;https://avatars1.githubusercontent.com/u/5562395?s=40&amp;v=4&quot; width=&quot;20&quot; /> </a>    <a class=&quot;avatar-link tooltipped tooltipped-s&quot; aria-label=&quot;normanheckscher&quot; href=&quot;/aymericdamien/TensorFlow-Examples/commits/dd2e6dcd9603d5de008d8c766453162d0204affa/examples/3_NeuralNetworks/convolutional_network.py?author=normanheckscher&quot;><img alt=&quot;@normanheckscher&quot; class=&quot;avatar&quot; height=&quot;20&quot; src=&quot;https://avatars1.githubusercontent.com/u/6240820?s=40&amp;v=4&quot; width=&quot;20&quot; /> </a>    <a class=&quot;avatar-link tooltipped tooltipped-s&quot; aria-label=&quot;alseambusher&quot; href=&quot;/aymericdamien/TensorFlow-Examples/commits/dd2e6dcd9603d5de008d8c766453162d0204affa/examples/3_NeuralNetworks/convolutional_network.py?author=alseambusher&quot;><img alt=&quot;@alseambusher&quot; class=&quot;avatar&quot; height=&quot;20&quot; src=&quot;https://avatars3.githubusercontent.com/u/1242542?s=40&amp;v=4&quot; width=&quot;20&quot; /> </a>    </div>    <div id=&quot;blob_contributors_box&quot; style=&quot;display:none&quot;>      <h2 class=&quot;facebox-header&quot; data-facebox-id=&quot;facebox-header&quot;>Users who have contributed to this file</h2>      <ul class=&quot;facebox-user-list&quot; data-facebox-id=&quot;facebox-description&quot;>          <li class=&quot;facebox-user-list-item&quot;>            <img alt=&quot;@RWalecki&quot; height=&quot;24&quot; src=&quot;https://avatars3.githubusercontent.com/u/1379960?s=48&amp;v=4&quot; width=&quot;24&quot; />            <a href=&quot;/RWalecki&quot;>RWalecki</a>          </li>          <li class=&quot;facebox-user-list-item&quot;>            <img alt=&quot;@aymericdamien&quot; height=&quot;24&quot; src=&quot;https://avatars1.githubusercontent.com/u/10386605?s=48&amp;v=4&quot; width=&quot;24&quot; />            <a href=&quot;/aymericdamien&quot;>aymericdamien</a>          </li>          <li class=&quot;facebox-user-list-item&quot;>            <img alt=&quot;@vra&quot; height=&quot;24&quot; src=&quot;https://avatars0.githubusercontent.com/u/5562395?s=48&amp;v=4&quot; width=&quot;24&quot; />            <a href=&quot;/vra&quot;>vra</a>          </li>          <li class=&quot;facebox-user-list-item&quot;>            <img alt=&quot;@normanheckscher&quot; height=&quot;24&quot; src=&quot;https://avatars0.githubusercontent.com/u/6240820?s=48&amp;v=4&quot; width=&quot;24&quot; />            <a href=&quot;/normanheckscher&quot;>normanheckscher</a>          </li>          <li class=&quot;facebox-user-list-item&quot;>            <img alt=&quot;@alseambusher&quot; height=&quot;24&quot; src=&quot;https://avatars2.githubusercontent.com/u/1242542?s=48&amp;v=4&quot; width=&quot;24&quot; />            <a href=&quot;/alseambusher&quot;>alseambusher</a>          </li>      </ul>    </div>  </div>  <div class=&quot;file&quot;>    <div class=&quot;file-header&quot;>  <div class=&quot;file-actions&quot;>    <div class=&quot;BtnGroup&quot;>      <a href=&quot;/aymericdamien/TensorFlow-Examples/raw/dd2e6dcd9603d5de008d8c766453162d0204affa/examples/3_NeuralNetworks/convolutional_network.py&quot; class=&quot;btn btn-sm BtnGroup-item&quot; id=&quot;raw-url&quot;>Raw</a>        <a href=&quot;/aymericdamien/TensorFlow-Examples/blame/dd2e6dcd9603d5de008d8c766453162d0204affa/examples/3_NeuralNetworks/convolutional_network.py&quot; class=&quot;btn btn-sm js-update-url-with-hash BtnGroup-item&quot; data-hotkey=&quot;b&quot;>Blame</a>      <a href=&quot;/aymericdamien/TensorFlow-Examples/commits/dd2e6dcd9603d5de008d8c766453162d0204affa/examples/3_NeuralNetworks/convolutional_network.py&quot; class=&quot;btn btn-sm BtnGroup-item&quot; rel=&quot;nofollow&quot;>History</a>    </div>        <button class=&quot;btn-octicon disabled tooltipped tooltipped-nw&quot;           type=&quot;button&quot;           disabled           aria-label=&quot;You must be on a branch to open this file in GitHub Desktop&quot;>            <svg aria-hidden=&quot;true&quot; class=&quot;octicon octicon-device-desktop&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;><path fill-rule=&quot;evenodd&quot; d=&quot;M15 2H1c-.55 0-1 .45-1 1v9c0 .55.45 1 1 1h5.34c-.25.61-.86 1.39-2.34 2h8c-1.48-.61-2.09-1.39-2.34-2H15c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm0 9H1V3h14v8z&quot;/></svg>        </button>        <button type=&quot;button&quot; class=&quot;btn-octicon disabled tooltipped tooltipped-nw&quot;          aria-label=&quot;You must be signed in to make or propose changes&quot;>          <svg aria-hidden=&quot;true&quot; class=&quot;octicon octicon-pencil&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 14 16&quot; width=&quot;14&quot;><path fill-rule=&quot;evenodd&quot; d=&quot;M0 12v3h3l8-8-3-3-8 8zm3 2H1v-2h1v1h1v1zm10.3-9.3L12 6 9 3l1.3-1.3a.996.996 0 0 1 1.41 0l1.59 1.59c.39.39.39 1.02 0 1.41z&quot;/></svg>        </button>        <button type=&quot;button&quot; class=&quot;btn-octicon btn-octicon-danger disabled tooltipped tooltipped-nw&quot;          aria-label=&quot;You must be signed in to make or propose changes&quot;>          <svg aria-hidden=&quot;true&quot; class=&quot;octicon octicon-trashcan&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 12 16&quot; width=&quot;12&quot;><path fill-rule=&quot;evenodd&quot; d=&quot;M11 2H9c0-.55-.45-1-1-1H5c-.55 0-1 .45-1 1H2c-.55 0-1 .45-1 1v1c0 .55.45 1 1 1v9c0 .55.45 1 1 1h7c.55 0 1-.45 1-1V5c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm-1 12H3V5h1v8h1V5h1v8h1V5h1v8h1V5h1v9zm1-10H2V3h9v1z&quot;/></svg>        </button>  </div>  <div class=&quot;file-info&quot;>      126 lines (97 sloc)      <span class=&quot;file-info-divider&quot;></span>    4.65 KB  </div></div>      <div itemprop=&quot;text&quot; class=&quot;blob-wrapper data type-python&quot;>      <table class=&quot;highlight tab-size js-file-line-container&quot; data-tab-size=&quot;8&quot;>      <tr>        <td id=&quot;L1&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;1&quot;></td>        <td id=&quot;LC1&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-s&quot;><span class=&quot;pl-pds&quot;>&quot;&quot;&quot;</span> Convolutional Neural Network.</span></td>      </tr>      <tr>        <td id=&quot;L2&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;2&quot;></td>        <td id=&quot;LC2&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-s&quot;></span></td>      </tr>      <tr>        <td id=&quot;L3&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;3&quot;></td>        <td id=&quot;LC3&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-s&quot;>Build and train a convolutional neural network with TensorFlow.</span></td>      </tr>      <tr>        <td id=&quot;L4&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;4&quot;></td>        <td id=&quot;LC4&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-s&quot;>This example is using the MNIST database of handwritten digits</span></td>      </tr>      <tr>        <td id=&quot;L5&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;5&quot;></td>        <td id=&quot;LC5&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-s&quot;>(http://yann.lecun.com/exdb/mnist/)</span></td>      </tr>      <tr>        <td id=&quot;L6&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;6&quot;></td>        <td id=&quot;LC6&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-s&quot;></span></td>      </tr>      <tr>        <td id=&quot;L7&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;7&quot;></td>        <td id=&quot;LC7&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-s&quot;>This example is using TensorFlow layers API, see &#39;convolutional_network_raw&#39; </span></td>      </tr>      <tr>        <td id=&quot;L8&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;8&quot;></td>        <td id=&quot;LC8&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-s&quot;>example for a raw implementation with variables.</span></td>      </tr>      <tr>        <td id=&quot;L9&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;9&quot;></td>        <td id=&quot;LC9&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-s&quot;></span></td>      </tr>      <tr>        <td id=&quot;L10&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;10&quot;></td>        <td id=&quot;LC10&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-s&quot;>Author: Aymeric Damien</span></td>      </tr>      <tr>        <td id=&quot;L11&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;11&quot;></td>        <td id=&quot;LC11&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-s&quot;>Project: https://github.com/aymericdamien/TensorFlow-Examples/</span></td>      </tr>      <tr>        <td id=&quot;L12&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;12&quot;></td>        <td id=&quot;LC12&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-s&quot;><span class=&quot;pl-pds&quot;>&quot;&quot;&quot;</span></span></td>      </tr>      <tr>        <td id=&quot;L13&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;13&quot;></td>        <td id=&quot;LC13&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-k&quot;>from</span> <span class=&quot;pl-c1&quot;>__future__</span> <span class=&quot;pl-k&quot;>import</span> division, print_function, absolute_import</td>      </tr>      <tr>        <td id=&quot;L14&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;14&quot;></td>        <td id=&quot;LC14&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;></td>      </tr>      <tr>        <td id=&quot;L15&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;15&quot;></td>        <td id=&quot;LC15&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Import MNIST data</span></td>      </tr>      <tr>        <td id=&quot;L16&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;16&quot;></td>        <td id=&quot;LC16&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-k&quot;>from</span> tensorflow.examples.tutorials.mnist <span class=&quot;pl-k&quot;>import</span> input_data</td>      </tr>      <tr>        <td id=&quot;L17&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;17&quot;></td>        <td id=&quot;LC17&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>mnist <span class=&quot;pl-k&quot;>=</span> input_data.read_data_sets(<span class=&quot;pl-s&quot;><span class=&quot;pl-pds&quot;>&quot;</span>/tmp/data/<span class=&quot;pl-pds&quot;>&quot;</span></span>, <span class=&quot;pl-v&quot;>one_hot</span><span class=&quot;pl-k&quot;>=</span><span class=&quot;pl-c1&quot;>False</span>)</td>      </tr>      <tr>        <td id=&quot;L18&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;18&quot;></td>        <td id=&quot;LC18&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;></td>      </tr>      <tr>        <td id=&quot;L19&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;19&quot;></td>        <td id=&quot;LC19&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-k&quot;>import</span> tensorflow <span class=&quot;pl-k&quot;>as</span> tf</td>      </tr>      <tr>        <td id=&quot;L20&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;20&quot;></td>        <td id=&quot;LC20&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;></td>      </tr>      <tr>        <td id=&quot;L21&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;21&quot;></td>        <td id=&quot;LC21&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Training Parameters</span></td>      </tr>      <tr>        <td id=&quot;L22&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;22&quot;></td>        <td id=&quot;LC22&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>learning_rate <span class=&quot;pl-k&quot;>=</span> <span class=&quot;pl-c1&quot;>0.001</span></td>      </tr>      <tr>        <td id=&quot;L23&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;23&quot;></td>        <td id=&quot;LC23&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>num_steps <span class=&quot;pl-k&quot;>=</span> <span class=&quot;pl-c1&quot;>2000</span></td>      </tr>      <tr>        <td id=&quot;L24&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;24&quot;></td>        <td id=&quot;LC24&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>batch_size <span class=&quot;pl-k&quot;>=</span> <span class=&quot;pl-c1&quot;>128</span></td>      </tr>      <tr>        <td id=&quot;L25&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;25&quot;></td>        <td id=&quot;LC25&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;></td>      </tr>      <tr>        <td id=&quot;L26&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;26&quot;></td>        <td id=&quot;LC26&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Network Parameters</span></td>      </tr>      <tr>        <td id=&quot;L27&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;27&quot;></td>        <td id=&quot;LC27&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>num_input <span class=&quot;pl-k&quot;>=</span> <span class=&quot;pl-c1&quot;>784</span> <span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> MNIST data input (img shape: 28*28)</span></td>      </tr>      <tr>        <td id=&quot;L28&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;28&quot;></td>        <td id=&quot;LC28&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>num_classes <span class=&quot;pl-k&quot;>=</span> <span class=&quot;pl-c1&quot;>10</span> <span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> MNIST total classes (0-9 digits)</span></td>      </tr>      <tr>        <td id=&quot;L29&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;29&quot;></td>        <td id=&quot;LC29&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>dropout <span class=&quot;pl-k&quot;>=</span> <span class=&quot;pl-c1&quot;>0.75</span> <span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Dropout, probability to keep units</span></td>      </tr>      <tr>        <td id=&quot;L30&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;30&quot;></td>        <td id=&quot;LC30&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;></td>      </tr>      <tr>        <td id=&quot;L31&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;31&quot;></td>        <td id=&quot;LC31&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;></td>      </tr>      <tr>        <td id=&quot;L32&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;32&quot;></td>        <td id=&quot;LC32&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Create the neural network</span></td>      </tr>      <tr>        <td id=&quot;L33&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;33&quot;></td>        <td id=&quot;LC33&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-k&quot;>def</span> <span class=&quot;pl-en&quot;>conv_net</span>(<span class=&quot;pl-smi&quot;>x_dict</span>, <span class=&quot;pl-smi&quot;>n_classes</span>, <span class=&quot;pl-smi&quot;>dropout</span>, <span class=&quot;pl-smi&quot;>reuse</span>, <span class=&quot;pl-smi&quot;>is_training</span>):</td>      </tr>      <tr>        <td id=&quot;L34&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;34&quot;></td>        <td id=&quot;LC34&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>    <span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Define a scope for reusing the variables</span></td>      </tr>      <tr>        <td id=&quot;L35&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;35&quot;></td>        <td id=&quot;LC35&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>    <span class=&quot;pl-k&quot;>with</span> tf.variable_scope(<span class=&quot;pl-s&quot;><span class=&quot;pl-pds&quot;>&#39;</span>ConvNet<span class=&quot;pl-pds&quot;>&#39;</span></span>, <span class=&quot;pl-v&quot;>reuse</span><span class=&quot;pl-k&quot;>=</span>reuse):</td>      </tr>      <tr>        <td id=&quot;L36&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;36&quot;></td>        <td id=&quot;LC36&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        <span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> TF Estimator input is a dict, in case of multiple inputs</span></td>      </tr>      <tr>        <td id=&quot;L37&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;37&quot;></td>        <td id=&quot;LC37&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        x <span class=&quot;pl-k&quot;>=</span> x_dict[<span class=&quot;pl-s&quot;><span class=&quot;pl-pds&quot;>&#39;</span>images<span class=&quot;pl-pds&quot;>&#39;</span></span>]</td>      </tr>      <tr>        <td id=&quot;L38&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;38&quot;></td>        <td id=&quot;LC38&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;></td>      </tr>      <tr>        <td id=&quot;L39&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;39&quot;></td>        <td id=&quot;LC39&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        <span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> MNIST data input is a 1-D vector of 784 features (28*28 pixels)</span></td>      </tr>      <tr>        <td id=&quot;L40&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;40&quot;></td>        <td id=&quot;LC40&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        <span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Reshape to match picture format [Height x Width x Channel]</span></td>      </tr>      <tr>        <td id=&quot;L41&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;41&quot;></td>        <td id=&quot;LC41&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        <span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Tensor input become 4-D: [Batch Size, Height, Width, Channel]</span></td>      </tr>      <tr>        <td id=&quot;L42&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;42&quot;></td>        <td id=&quot;LC42&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        x <span class=&quot;pl-k&quot;>=</span> tf.reshape(x, <span class=&quot;pl-v&quot;>shape</span><span class=&quot;pl-k&quot;>=</span>[<span class=&quot;pl-k&quot;>-</span><span class=&quot;pl-c1&quot;>1</span>, <span class=&quot;pl-c1&quot;>28</span>, <span class=&quot;pl-c1&quot;>28</span>, <span class=&quot;pl-c1&quot;>1</span>])</td>      </tr>      <tr>        <td id=&quot;L43&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;43&quot;></td>        <td id=&quot;LC43&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;></td>      </tr>      <tr>        <td id=&quot;L44&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;44&quot;></td>        <td id=&quot;LC44&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        <span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Convolution Layer with 32 filters and a kernel size of 5</span></td>      </tr>      <tr>        <td id=&quot;L45&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;45&quot;></td>        <td id=&quot;LC45&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        conv1 <span class=&quot;pl-k&quot;>=</span> tf.layers.conv2d(x, <span class=&quot;pl-c1&quot;>32</span>, <span class=&quot;pl-c1&quot;>5</span>, <span class=&quot;pl-v&quot;>activation</span><span class=&quot;pl-k&quot;>=</span>tf.nn.relu)</td>      </tr>      <tr>        <td id=&quot;L46&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;46&quot;></td>        <td id=&quot;LC46&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        <span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Max Pooling (down-sampling) with strides of 2 and kernel size of 2</span></td>      </tr>      <tr>        <td id=&quot;L47&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;47&quot;></td>        <td id=&quot;LC47&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        conv1 <span class=&quot;pl-k&quot;>=</span> tf.layers.max_pooling2d(conv1, <span class=&quot;pl-c1&quot;>2</span>, <span class=&quot;pl-c1&quot;>2</span>)</td>      </tr>      <tr>        <td id=&quot;L48&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;48&quot;></td>        <td id=&quot;LC48&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;></td>      </tr>      <tr>        <td id=&quot;L49&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;49&quot;></td>        <td id=&quot;LC49&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        <span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Convolution Layer with 64 filters and a kernel size of 3</span></td>      </tr>      <tr>        <td id=&quot;L50&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;50&quot;></td>        <td id=&quot;LC50&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        conv2 <span class=&quot;pl-k&quot;>=</span> tf.layers.conv2d(conv1, <span class=&quot;pl-c1&quot;>64</span>, <span class=&quot;pl-c1&quot;>3</span>, <span class=&quot;pl-v&quot;>activation</span><span class=&quot;pl-k&quot;>=</span>tf.nn.relu)</td>      </tr>      <tr>        <td id=&quot;L51&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;51&quot;></td>        <td id=&quot;LC51&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        <span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Max Pooling (down-sampling) with strides of 2 and kernel size of 2</span></td>      </tr>      <tr>        <td id=&quot;L52&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;52&quot;></td>        <td id=&quot;LC52&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        conv2 <span class=&quot;pl-k&quot;>=</span> tf.layers.max_pooling2d(conv2, <span class=&quot;pl-c1&quot;>2</span>, <span class=&quot;pl-c1&quot;>2</span>)</td>      </tr>      <tr>        <td id=&quot;L53&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;53&quot;></td>        <td id=&quot;LC53&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;></td>      </tr>      <tr>        <td id=&quot;L54&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;54&quot;></td>        <td id=&quot;LC54&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        <span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Flatten the data to a 1-D vector for the fully connected layer</span></td>      </tr>      <tr>        <td id=&quot;L55&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;55&quot;></td>        <td id=&quot;LC55&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        fc1 <span class=&quot;pl-k&quot;>=</span> tf.contrib.layers.flatten(conv2)</td>      </tr>      <tr>        <td id=&quot;L56&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;56&quot;></td>        <td id=&quot;LC56&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;></td>      </tr>      <tr>        <td id=&quot;L57&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;57&quot;></td>        <td id=&quot;LC57&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        <span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Fully connected layer (in tf contrib folder for now)</span></td>      </tr>      <tr>        <td id=&quot;L58&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;58&quot;></td>        <td id=&quot;LC58&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        fc1 <span class=&quot;pl-k&quot;>=</span> tf.layers.dense(fc1, <span class=&quot;pl-c1&quot;>1024</span>)</td>      </tr>      <tr>        <td id=&quot;L59&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;59&quot;></td>        <td id=&quot;LC59&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        <span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Apply Dropout (if is_training is False, dropout is not applied)</span></td>      </tr>      <tr>        <td id=&quot;L60&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;60&quot;></td>        <td id=&quot;LC60&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        fc1 <span class=&quot;pl-k&quot;>=</span> tf.layers.dropout(fc1, <span class=&quot;pl-v&quot;>rate</span><span class=&quot;pl-k&quot;>=</span>dropout, <span class=&quot;pl-v&quot;>training</span><span class=&quot;pl-k&quot;>=</span>is_training)</td>      </tr>      <tr>        <td id=&quot;L61&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;61&quot;></td>        <td id=&quot;LC61&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;></td>      </tr>      <tr>        <td id=&quot;L62&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;62&quot;></td>        <td id=&quot;LC62&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        <span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Output layer, class prediction</span></td>      </tr>      <tr>        <td id=&quot;L63&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;63&quot;></td>        <td id=&quot;LC63&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        out <span class=&quot;pl-k&quot;>=</span> tf.layers.dense(fc1, n_classes)</td>      </tr>      <tr>        <td id=&quot;L64&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;64&quot;></td>        <td id=&quot;LC64&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;></td>      </tr>      <tr>        <td id=&quot;L65&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;65&quot;></td>        <td id=&quot;LC65&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>    <span class=&quot;pl-k&quot;>return</span> out</td>      </tr>      <tr>        <td id=&quot;L66&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;66&quot;></td>        <td id=&quot;LC66&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;></td>      </tr>      <tr>        <td id=&quot;L67&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;67&quot;></td>        <td id=&quot;LC67&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;></td>      </tr>      <tr>        <td id=&quot;L68&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;68&quot;></td>        <td id=&quot;LC68&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Define the model function (following TF Estimator Template)</span></td>      </tr>      <tr>        <td id=&quot;L69&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;69&quot;></td>        <td id=&quot;LC69&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-k&quot;>def</span> <span class=&quot;pl-en&quot;>model_fn</span>(<span class=&quot;pl-smi&quot;>features</span>, <span class=&quot;pl-smi&quot;>labels</span>, <span class=&quot;pl-smi&quot;>mode</span>):</td>      </tr>      <tr>        <td id=&quot;L70&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;70&quot;></td>        <td id=&quot;LC70&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>    <span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Build the neural network</span></td>      </tr>      <tr>        <td id=&quot;L71&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;71&quot;></td>        <td id=&quot;LC71&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>    <span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Because Dropout have different behavior at training and prediction time, we</span></td>      </tr>      <tr>        <td id=&quot;L72&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;72&quot;></td>        <td id=&quot;LC72&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>    <span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> need to create 2 distinct computation graphs that still share the same weights.</span></td>      </tr>      <tr>        <td id=&quot;L73&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;73&quot;></td>        <td id=&quot;LC73&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>    logits_train <span class=&quot;pl-k&quot;>=</span> conv_net(features, num_classes, dropout, <span class=&quot;pl-v&quot;>reuse</span><span class=&quot;pl-k&quot;>=</span><span class=&quot;pl-c1&quot;>False</span>,</td>      </tr>      <tr>        <td id=&quot;L74&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;74&quot;></td>        <td id=&quot;LC74&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>                            <span class=&quot;pl-v&quot;>is_training</span><span class=&quot;pl-k&quot;>=</span><span class=&quot;pl-c1&quot;>True</span>)</td>      </tr>      <tr>        <td id=&quot;L75&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;75&quot;></td>        <td id=&quot;LC75&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>    logits_test <span class=&quot;pl-k&quot;>=</span> conv_net(features, num_classes, dropout, <span class=&quot;pl-v&quot;>reuse</span><span class=&quot;pl-k&quot;>=</span><span class=&quot;pl-c1&quot;>True</span>,</td>      </tr>      <tr>        <td id=&quot;L76&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;76&quot;></td>        <td id=&quot;LC76&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>                           <span class=&quot;pl-v&quot;>is_training</span><span class=&quot;pl-k&quot;>=</span><span class=&quot;pl-c1&quot;>False</span>)</td>      </tr>      <tr>        <td id=&quot;L77&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;77&quot;></td>        <td id=&quot;LC77&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;></td>      </tr>      <tr>        <td id=&quot;L78&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;78&quot;></td>        <td id=&quot;LC78&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>    <span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Predictions</span></td>      </tr>      <tr>        <td id=&quot;L79&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;79&quot;></td>        <td id=&quot;LC79&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>    pred_classes <span class=&quot;pl-k&quot;>=</span> tf.argmax(logits_test, <span class=&quot;pl-v&quot;>axis</span><span class=&quot;pl-k&quot;>=</span><span class=&quot;pl-c1&quot;>1</span>)</td>      </tr>      <tr>        <td id=&quot;L80&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;80&quot;></td>        <td id=&quot;LC80&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>    pred_probas <span class=&quot;pl-k&quot;>=</span> tf.nn.softmax(logits_test)</td>      </tr>      <tr>        <td id=&quot;L81&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;81&quot;></td>        <td id=&quot;LC81&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;></td>      </tr>      <tr>        <td id=&quot;L82&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;82&quot;></td>        <td id=&quot;LC82&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>    <span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> If prediction mode, early return</span></td>      </tr>      <tr>        <td id=&quot;L83&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;83&quot;></td>        <td id=&quot;LC83&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>    <span class=&quot;pl-k&quot;>if</span> mode <span class=&quot;pl-k&quot;>==</span> tf.estimator.ModeKeys.<span class=&quot;pl-c1&quot;>PREDICT</span>:</td>      </tr>      <tr>        <td id=&quot;L84&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;84&quot;></td>        <td id=&quot;LC84&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        <span class=&quot;pl-k&quot;>return</span> tf.estimator.EstimatorSpec(mode, <span class=&quot;pl-v&quot;>predictions</span><span class=&quot;pl-k&quot;>=</span>pred_classes)</td>      </tr>      <tr>        <td id=&quot;L85&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;85&quot;></td>        <td id=&quot;LC85&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;></td>      </tr>      <tr>        <td id=&quot;L86&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;86&quot;></td>        <td id=&quot;LC86&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        <span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Define loss and optimizer</span></td>      </tr>      <tr>        <td id=&quot;L87&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;87&quot;></td>        <td id=&quot;LC87&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>    loss_op <span class=&quot;pl-k&quot;>=</span> tf.reduce_mean(tf.nn.sparse_softmax_cross_entropy_with_logits(</td>      </tr>      <tr>        <td id=&quot;L88&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;88&quot;></td>        <td id=&quot;LC88&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        <span class=&quot;pl-v&quot;>logits</span><span class=&quot;pl-k&quot;>=</span>logits_train, <span class=&quot;pl-v&quot;>labels</span><span class=&quot;pl-k&quot;>=</span>tf.cast(labels, <span class=&quot;pl-v&quot;>dtype</span><span class=&quot;pl-k&quot;>=</span>tf.int32)))</td>      </tr>      <tr>        <td id=&quot;L89&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;89&quot;></td>        <td id=&quot;LC89&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>    optimizer <span class=&quot;pl-k&quot;>=</span> tf.train.AdamOptimizer(<span class=&quot;pl-v&quot;>learning_rate</span><span class=&quot;pl-k&quot;>=</span>learning_rate)</td>      </tr>      <tr>        <td id=&quot;L90&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;90&quot;></td>        <td id=&quot;LC90&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>    train_op <span class=&quot;pl-k&quot;>=</span> optimizer.minimize(loss_op,</td>      </tr>      <tr>        <td id=&quot;L91&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;91&quot;></td>        <td id=&quot;LC91&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>                                  <span class=&quot;pl-v&quot;>global_step</span><span class=&quot;pl-k&quot;>=</span>tf.train.get_global_step())</td>      </tr>      <tr>        <td id=&quot;L92&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;92&quot;></td>        <td id=&quot;LC92&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;></td>      </tr>      <tr>        <td id=&quot;L93&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;93&quot;></td>        <td id=&quot;LC93&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>    <span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Evaluate the accuracy of the model</span></td>      </tr>      <tr>        <td id=&quot;L94&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;94&quot;></td>        <td id=&quot;LC94&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>    acc_op <span class=&quot;pl-k&quot;>=</span> tf.metrics.accuracy(<span class=&quot;pl-v&quot;>labels</span><span class=&quot;pl-k&quot;>=</span>labels, <span class=&quot;pl-v&quot;>predictions</span><span class=&quot;pl-k&quot;>=</span>pred_classes)</td>      </tr>      <tr>        <td id=&quot;L95&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;95&quot;></td>        <td id=&quot;LC95&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;></td>      </tr>      <tr>        <td id=&quot;L96&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;96&quot;></td>        <td id=&quot;LC96&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>    <span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> TF Estimators requires to return a EstimatorSpec, that specify</span></td>      </tr>      <tr>        <td id=&quot;L97&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;97&quot;></td>        <td id=&quot;LC97&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>    <span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> the different ops for training, evaluating, ...</span></td>      </tr>      <tr>        <td id=&quot;L98&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;98&quot;></td>        <td id=&quot;LC98&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>    estim_specs <span class=&quot;pl-k&quot;>=</span> tf.estimator.EstimatorSpec(</td>      </tr>      <tr>        <td id=&quot;L99&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;99&quot;></td>        <td id=&quot;LC99&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        <span class=&quot;pl-v&quot;>mode</span><span class=&quot;pl-k&quot;>=</span>mode,</td>      </tr>      <tr>        <td id=&quot;L100&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;100&quot;></td>        <td id=&quot;LC100&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        <span class=&quot;pl-v&quot;>predictions</span><span class=&quot;pl-k&quot;>=</span>pred_classes,</td>      </tr>      <tr>        <td id=&quot;L101&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;101&quot;></td>        <td id=&quot;LC101&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        <span class=&quot;pl-v&quot;>loss</span><span class=&quot;pl-k&quot;>=</span>loss_op,</td>      </tr>      <tr>        <td id=&quot;L102&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;102&quot;></td>        <td id=&quot;LC102&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        <span class=&quot;pl-v&quot;>train_op</span><span class=&quot;pl-k&quot;>=</span>train_op,</td>      </tr>      <tr>        <td id=&quot;L103&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;103&quot;></td>        <td id=&quot;LC103&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>        <span class=&quot;pl-v&quot;>eval_metric_ops</span><span class=&quot;pl-k&quot;>=</span>{<span class=&quot;pl-s&quot;><span class=&quot;pl-pds&quot;>&#39;</span>accuracy<span class=&quot;pl-pds&quot;>&#39;</span></span>: acc_op})</td>      </tr>      <tr>        <td id=&quot;L104&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;104&quot;></td>        <td id=&quot;LC104&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;></td>      </tr>      <tr>        <td id=&quot;L105&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;105&quot;></td>        <td id=&quot;LC105&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>    <span class=&quot;pl-k&quot;>return</span> estim_specs</td>      </tr>      <tr>        <td id=&quot;L106&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;106&quot;></td>        <td id=&quot;LC106&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;></td>      </tr>      <tr>        <td id=&quot;L107&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;107&quot;></td>        <td id=&quot;LC107&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Build the Estimator</span></td>      </tr>      <tr>        <td id=&quot;L108&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;108&quot;></td>        <td id=&quot;LC108&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>model <span class=&quot;pl-k&quot;>=</span> tf.estimator.Estimator(model_fn)</td>      </tr>      <tr>        <td id=&quot;L109&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;109&quot;></td>        <td id=&quot;LC109&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;></td>      </tr>      <tr>        <td id=&quot;L110&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;110&quot;></td>        <td id=&quot;LC110&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Define the input function for training</span></td>      </tr>      <tr>        <td id=&quot;L111&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;111&quot;></td>        <td id=&quot;LC111&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>input_fn <span class=&quot;pl-k&quot;>=</span> tf.estimator.inputs.numpy_input_fn(</td>      </tr>      <tr>        <td id=&quot;L112&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;112&quot;></td>        <td id=&quot;LC112&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>    <span class=&quot;pl-v&quot;>x</span><span class=&quot;pl-k&quot;>=</span>{<span class=&quot;pl-s&quot;><span class=&quot;pl-pds&quot;>&#39;</span>images<span class=&quot;pl-pds&quot;>&#39;</span></span>: mnist.train.images}, <span class=&quot;pl-v&quot;>y</span><span class=&quot;pl-k&quot;>=</span>mnist.train.labels,</td>      </tr>      <tr>        <td id=&quot;L113&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;113&quot;></td>        <td id=&quot;LC113&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>    <span class=&quot;pl-v&quot;>batch_size</span><span class=&quot;pl-k&quot;>=</span>batch_size, <span class=&quot;pl-v&quot;>num_epochs</span><span class=&quot;pl-k&quot;>=</span><span class=&quot;pl-c1&quot;>None</span>, <span class=&quot;pl-v&quot;>shuffle</span><span class=&quot;pl-k&quot;>=</span><span class=&quot;pl-c1&quot;>True</span>)</td>      </tr>      <tr>        <td id=&quot;L114&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;114&quot;></td>        <td id=&quot;LC114&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Train the Model</span></td>      </tr>      <tr>        <td id=&quot;L115&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;115&quot;></td>        <td id=&quot;LC115&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>model.train(input_fn, <span class=&quot;pl-v&quot;>steps</span><span class=&quot;pl-k&quot;>=</span>num_steps)</td>      </tr>      <tr>        <td id=&quot;L116&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;116&quot;></td>        <td id=&quot;LC116&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;></td>      </tr>      <tr>        <td id=&quot;L117&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;117&quot;></td>        <td id=&quot;LC117&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Evaluate the Model</span></td>      </tr>      <tr>        <td id=&quot;L118&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;118&quot;></td>        <td id=&quot;LC118&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Define the input function for evaluating</span></td>      </tr>      <tr>        <td id=&quot;L119&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;119&quot;></td>        <td id=&quot;LC119&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>input_fn <span class=&quot;pl-k&quot;>=</span> tf.estimator.inputs.numpy_input_fn(</td>      </tr>      <tr>        <td id=&quot;L120&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;120&quot;></td>        <td id=&quot;LC120&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>    <span class=&quot;pl-v&quot;>x</span><span class=&quot;pl-k&quot;>=</span>{<span class=&quot;pl-s&quot;><span class=&quot;pl-pds&quot;>&#39;</span>images<span class=&quot;pl-pds&quot;>&#39;</span></span>: mnist.test.images}, <span class=&quot;pl-v&quot;>y</span><span class=&quot;pl-k&quot;>=</span>mnist.test.labels,</td>      </tr>      <tr>        <td id=&quot;L121&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;121&quot;></td>        <td id=&quot;LC121&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>    <span class=&quot;pl-v&quot;>batch_size</span><span class=&quot;pl-k&quot;>=</span>batch_size, <span class=&quot;pl-v&quot;>shuffle</span><span class=&quot;pl-k&quot;>=</span><span class=&quot;pl-c1&quot;>False</span>)</td>      </tr>      <tr>        <td id=&quot;L122&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;122&quot;></td>        <td id=&quot;LC122&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-c&quot;><span class=&quot;pl-c&quot;>#</span> Use the Estimator &#39;evaluate&#39; method</span></td>      </tr>      <tr>        <td id=&quot;L123&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;123&quot;></td>        <td id=&quot;LC123&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;>e <span class=&quot;pl-k&quot;>=</span> model.evaluate(input_fn)</td>      </tr>      <tr>        <td id=&quot;L124&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;124&quot;></td>        <td id=&quot;LC124&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;></td>      </tr>      <tr>        <td id=&quot;L125&quot; class=&quot;blob-num js-line-number&quot; data-line-number=&quot;125&quot;></td>        <td id=&quot;LC125&quot; class=&quot;blob-code blob-code-inner js-file-line&quot;><span class=&quot;pl-c1&quot;>print</span>(<span class=&quot;pl-s&quot;><span class=&quot;pl-pds&quot;>&quot;</span>Testing Accuracy:<span class=&quot;pl-pds&quot;>&quot;</span></span>, e[<span class=&quot;pl-s&quot;><span class=&quot;pl-pds&quot;>&#39;</span>accuracy<span class=&quot;pl-pds&quot;>&#39;</span></span>])</td>      </tr></table>  <div class=&quot;BlobToolbar position-absolute js-file-line-actions dropdown js-menu-container js-select-menu d-none&quot; aria-hidden=&quot;true&quot;>    <button class=&quot;btn-octicon ml-0 px-2 p-0 bg-white border border-gray-dark rounded-1 dropdown-toggle js-menu-target&quot; id=&quot;js-file-line-action-button&quot; type=&quot;button&quot; aria-expanded=&quot;false&quot; aria-haspopup=&quot;true&quot; aria-label=&quot;Inline file action toolbar&quot; aria-controls=&quot;inline-file-actions&quot;>      <svg aria-hidden=&quot;true&quot; class=&quot;octicon octicon-kebab-horizontal&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 13 16&quot; width=&quot;13&quot;><path fill-rule=&quot;evenodd&quot; d=&quot;M1.5 9a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z&quot;/></svg>    </button>    <div class=&quot;dropdown-menu-content js-menu-content&quot; id=&quot;inline-file-actions&quot;>      <ul class=&quot;BlobToolbar-dropdown dropdown-menu dropdown-menu-se mt-2&quot;>        <li><a class=&quot;js-zeroclipboard dropdown-item&quot; style=&quot;cursor:pointer;&quot; id=&quot;js-copy-lines&quot; data-original-text=&quot;Copy lines&quot;>Copy lines</a></li>        <li><a class=&quot;js-zeroclipboard dropdown-item&quot; id= &quot;js-copy-permalink&quot; style=&quot;cursor:pointer;&quot; data-original-text=&quot;Copy permalink&quot;>Copy permalink</a></li>        <li><a href=&quot;/aymericdamien/TensorFlow-Examples/blame/dd2e6dcd9603d5de008d8c766453162d0204affa/examples/3_NeuralNetworks/convolutional_network.py&quot; class=&quot;dropdown-item js-update-url-with-hash&quot; id=&quot;js-view-git-blame&quot;>View git blame</a></li>          <li><a href=&quot;/aymericdamien/TensorFlow-Examples/issues/new&quot; class=&quot;dropdown-item&quot; id=&quot;js-new-issue&quot;>Open new issue</a></li>      </ul>    </div>  </div>  </div>  </div>  <button type=&quot;button&quot; data-facebox=&quot;#jump-to-line&quot; data-facebox-class=&quot;linejump&quot; data-hotkey=&quot;l&quot; class=&quot;d-none&quot;>Jump to Line</button>  <div id=&quot;jump-to-line&quot; style=&quot;display:none&quot;>    <!-- '&quot;` --><!-- </textarea></xmp> --></option></form><form accept-charset=&quot;UTF-8&quot; action=&quot;&quot; class=&quot;js-jump-to-line-form&quot; method=&quot;get&quot;><div style=&quot;margin:0;padding:0;display:inline&quot;><input name=&quot;utf8&quot; type=&quot;hidden&quot; value=&quot;&#x2713;&quot; /></div>      <input class=&quot;form-control linejump-input js-jump-to-line-field&quot; type=&quot;text&quot; placeholder=&quot;Jump to line&hellip;&quot; aria-label=&quot;Jump to line&quot; autofocus>      <button type=&quot;submit&quot; class=&quot;btn&quot;>Go</button></form>  </div>  </div>  <div class=&quot;modal-backdrop js-touch-events&quot;></div></div>    </div>  </div>  </div>      <div class=&quot;footer container-lg px-3&quot; role=&quot;contentinfo&quot;>  <div class=&quot;position-relative d-flex flex-justify-between py-6 mt-6 f6 text-gray border-top border-gray-light &quot;>    <ul class=&quot;list-style-none d-flex flex-wrap &quot;>      <li class=&quot;mr-3&quot;>&copy; 2018 <span title=&quot;0.17610s from unicorn-1447924677-ct3cn&quot;>GitHub</span>, Inc.</li>        <li class=&quot;mr-3&quot;><a href=&quot;https://github.com/site/terms&quot; data-ga-click=&quot;Footer, go to terms, text:terms&quot;>Terms</a></li>        <li class=&quot;mr-3&quot;><a href=&quot;https://github.com/site/privacy&quot; data-ga-click=&quot;Footer, go to privacy, text:privacy&quot;>Privacy</a></li>        <li class=&quot;mr-3&quot;><a href=&quot;https://github.com/security&quot; data-ga-click=&quot;Footer, go to security, text:security&quot;>Security</a></li>        <li class=&quot;mr-3&quot;><a href=&quot;https://status.github.com/&quot; data-ga-click=&quot;Footer, go to status, text:status&quot;>Status</a></li>        <li><a href=&quot;https://help.github.com&quot; data-ga-click=&quot;Footer, go to help, text:help&quot;>Help</a></li>    </ul>    <a href=&quot;https://github.com&quot; aria-label=&quot;Homepage&quot; class=&quot;footer-octicon&quot; title=&quot;GitHub&quot;>      <svg aria-hidden=&quot;true&quot; class=&quot;octicon octicon-mark-github&quot; height=&quot;24&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;24&quot;><path fill-rule=&quot;evenodd&quot; d=&quot;M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z&quot;/></svg></a>    <ul class=&quot;list-style-none d-flex flex-wrap &quot;>        <li class=&quot;mr-3&quot;><a href=&quot;https://github.com/contact&quot; data-ga-click=&quot;Footer, go to contact, text:contact&quot;>Contact GitHub</a></li>      <li class=&quot;mr-3&quot;><a href=&quot;https://developer.github.com&quot; data-ga-click=&quot;Footer, go to api, text:api&quot;>API</a></li>      <li class=&quot;mr-3&quot;><a href=&quot;https://training.github.com&quot; data-ga-click=&quot;Footer, go to training, text:training&quot;>Training</a></li>      <li class=&quot;mr-3&quot;><a href=&quot;https://shop.github.com&quot; data-ga-click=&quot;Footer, go to shop, text:shop&quot;>Shop</a></li>        <li class=&quot;mr-3&quot;><a href=&quot;https://github.com/blog&quot; data-ga-click=&quot;Footer, go to blog, text:blog&quot;>Blog</a></li>        <li><a href=&quot;https://github.com/about&quot; data-ga-click=&quot;Footer, go to about, text:about&quot;>About</a></li>    </ul>  </div></div>  <div id=&quot;ajax-error-message&quot; class=&quot;ajax-error-message flash flash-error&quot;>    <svg aria-hidden=&quot;true&quot; class=&quot;octicon octicon-alert&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;><path fill-rule=&quot;evenodd&quot; d=&quot;M8.865 1.52c-.18-.31-.51-.5-.87-.5s-.69.19-.87.5L.275 13.5c-.18.31-.18.69 0 1 .19.31.52.5.87.5h13.7c.36 0 .69-.19.86-.5.17-.31.18-.69.01-1L8.865 1.52zM8.995 13h-2v-2h2v2zm0-3h-2V6h2v4z&quot;/></svg>    <button type=&quot;button&quot; class=&quot;flash-close js-ajax-error-dismiss&quot; aria-label=&quot;Dismiss error&quot;>      <svg aria-hidden=&quot;true&quot; class=&quot;octicon octicon-x&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 12 16&quot; width=&quot;12&quot;><path fill-rule=&quot;evenodd&quot; d=&quot;M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48z&quot;/></svg>    </button>    You can't perform that action at this time.  </div>        <script crossorigin=&quot;anonymous&quot; integrity=&quot;sha512-jqvDaL8uGENbC1rsifCdxmfE5RQmxtizkQ1xMGfvpSbwdKnG1vYz/z/BKuMEtJxU7/cY0IFKZlpgmUrMPtu4oQ==&quot; src=&quot;https://assets-cdn.github.com/assets/frameworks-8eabc368bf2e.js&quot; type=&quot;application/javascript&quot;></script>        <script async=&quot;async&quot; crossorigin=&quot;anonymous&quot; integrity=&quot;sha512-/zH/kvc1hfMVo2OQ6fRVyZdjmsioQ2rsGfYOeiJ4XnE0mNXeD1hSXT2ZJ2osKPuUkkq5IdVZ0QXlcqu7/DEZqg==&quot; src=&quot;https://assets-cdn.github.com/assets/github-ff31ff92f735.js&quot; type=&quot;application/javascript&quot;></script>                  <div class=&quot;js-stale-session-flash stale-session-flash flash flash-warn flash-banner d-none&quot;>    <svg aria-hidden=&quot;true&quot; class=&quot;octicon octicon-alert&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;><path fill-rule=&quot;evenodd&quot; d=&quot;M8.865 1.52c-.18-.31-.51-.5-.87-.5s-.69.19-.87.5L.275 13.5c-.18.31-.18.69 0 1 .19.31.52.5.87.5h13.7c.36 0 .69-.19.86-.5.17-.31.18-.69.01-1L8.865 1.52zM8.995 13h-2v-2h2v2zm0-3h-2V6h2v4z&quot;/></svg>    <span class=&quot;signed-in-tab-flash&quot;>You signed in with another tab or window. <a href=&quot;&quot;>Reload</a> to refresh your session.</span>    <span class=&quot;signed-out-tab-flash&quot;>You signed out in another tab or window. <a href=&quot;&quot;>Reload</a> to refresh your session.</span>  </div>  <div class=&quot;facebox&quot; id=&quot;facebox&quot; style=&quot;display:none;&quot;>  <div class=&quot;facebox-popup&quot;>    <div class=&quot;facebox-content&quot; role=&quot;dialog&quot; aria-labelledby=&quot;facebox-header&quot; aria-describedby=&quot;facebox-description&quot;>    </div>    <button type=&quot;button&quot; class=&quot;facebox-close js-facebox-close&quot; aria-label=&quot;Close modal&quot;>      <svg aria-hidden=&quot;true&quot; class=&quot;octicon octicon-x&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 12 16&quot; width=&quot;12&quot;><path fill-rule=&quot;evenodd&quot; d=&quot;M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48z&quot;/></svg>    </button>  </div></div>    </body></html>" width="1000" height="550" sandbox="allow-scripts"></iframe>

</section>

<section markdown="1">
<h3>The Problem</h3>

* Non-local information and complex semantics
  * `reshape` (line 42) needs original shape
  * `reshape` (line 42) for `conv2d` (line 45)

* Information never explicit in the code

* Tutorial has information in comments
  * real code has such comments too
  * examples at IBM, other places

</section>

<section markdown="1">
<h3>How types and analysis help</h3>

* Comments have severe limitations
  * tedious to write
  * error prone
  * no semantics

* Tensor dataflow information is vital
  * tensors are complex
  * API requirements are complex
  * data flow is complex

* Analysis tracks tensor "types"
  * "types" capture element meanings, dimensions
  * only vital declarations; preserve flexible, dynamic Python
  
</section>

<section markdown="1">
<h3>Express semantics of data</h3>

* Only MNIST arrays declared explicitly
~~~~
mnist : {
 training : {images : [channel; x(28)*y(28); batch]}, 
 test : {images : [channel; x(28)*y(28); batch]}
}
mnist = input_data.read_data_sets(...)
~~~~
* Information must be tracked in the code
~~~~
[channel; x(28)*y(28); batch] ->
  [channel; 1; x(28); y(28); batch]
x = tf.reshape(x, shape=[-1, 28, 28, 1])
~~~~
* Types so far for structs and tensors
  * struct: `var : { ("field" : type)* }`
  * tensor: `[ type ; label?(size)* ]`
  
</section>

<section markdown="1">
<h3>Analysis challenges</h3>

~~~~
def conv_net(x_dict, n_classes, dropout, reuse, is_training):
    with tf.variable_scope('ConvNet', reuse=reuse):
        x = x_dict['images']
~~~~
* Python data structures like dictionaries, objects
~~~~
def model_fn(features, labels, mode):
    logits_train = conv_net(features, num_classes, dropout, reuse=False,
is_training=True)
~~~~
* Interprocedural control- and data-flow
~~~~
model = tf.estimator.Estimator(model_fn)
input_fn = tf.estimator.inputs.numpy_input_fn(
    x={'images': mnist.train.images}, y=mnist.train.labels,
    batch_size=batch_size, num_epochs=None, shuffle=True)
model.train(input_fn, steps=num_steps)
~~~~
* `model.train` ultimately calls `model_fn`

</section>

<section markdown="1">
<h3>Status</h3>

* Type system under development
  * examples on slides not recommended syntax

* Analysis prototype being built with <a href="https://github.com/wala/WALA">WALA</a>
  * front end built with <a href="http://www.jython.com">Jython</a> for ASTs
  * use common front end support in WALA
  * some trivial call graphs work, much to be done
  * code being developed on <a href="https://github.com/wala/ML">Github</a>

* Tensorflow APIs will be modeled with WALA
  * reuse support that models the DOM, J2EE

</section>
